openapi: 3.0.1
info:
  title: Cube Codes Share Repository
  description: Allows to upload a cube-codes-ide app state and share it
  contact:
    email: info@cube.codes
  version: 1.0.0
paths:
  /appStates:
    post:
      summary: Add a new app state to the repository
      operationId: addAppState
      requestBody:
        description: App state that is added to the repository
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AppState'
        required: true
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UploadSuccess'
        400:
          description: Client error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /appStates/{id}:
    get:
      summary: Gets an app state from the repository
      operationId: getAppState
      parameters:
        - name: id
          in: path
          description: app state id
          required: true
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AppState'
        400:
          description: Client error
          content:
            application/xml:
              schema:
                $ref: '#/components/schemas/S3Error'
components:
  schemas:
    UploadSuccess:
      type: object
      properties:
        url:
          type: string
    Error:
      type: object
      properties:
        message:
          type: string
    S3Error: {}
    CubeSpecification:
      type: object
      properties:
        edgeLength:
          type: integer
          format: int32
    CubeSolutionPredicate:
      type: object
      properties:
        type:
          type: integer
          format: int32
    CubeHistory:
      type: object
      properties:
        entries:
          type: array
          items:
            type: array
            items:
              type: integer
              format: int32
        currentPosition:
          type: integer
          format: int32
    ProgramEditor:
      type: object
      properties:
        code:
          type: string
        collapsed:
          type: boolean
    OnloadAction:
      type: object
      properties:
        type:
          type: string
          enum:
          - none
          - programCodeRun
          - programCodeRunFast
          - historyStepAhead
          - historyStepBack
          - historyPlayAhead
          - historyPlayBack
    AppState:
      type: object
      properties:
        title:
          type: string
        description:
          type: string
        spec:
          $ref: '#/components/schemas/CubeSpecification'
        solutionPredicate:
          $ref: '#/components/schemas/CubeSolutionPredicate'
        history:
          $ref: '#/components/schemas/CubeHistory'
        programEditor:
          $ref: '#/components/schemas/ProgramEditor'
        onloadAction:
          $ref: '#/components/schemas/OnloadAction'
